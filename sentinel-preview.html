<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinel - Safety & Alignment Monitor</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { ResponsiveContainer, LineChart, Line } = Recharts;

        // Lucide icons as inline SVG components (simplified)
        const Shield = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
        );

        const Terminal = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <polyline points="4 17 10 11 4 5"></polyline>
                <line x1="12" y1="19" x2="20" y2="19"></line>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Cpu = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect>
                <rect x="9" y="9" width="6" height="6"></rect>
                <line x1="9" y1="1" x2="9" y2="4"></line>
                <line x1="15" y1="1" x2="15" y2="4"></line>
                <line x1="9" y1="20" x2="9" y2="23"></line>
                <line x1="15" y1="20" x2="15" y2="23"></line>
                <line x1="20" y1="9" x2="23" y2="9"></line>
                <line x1="20" y1="14" x2="23" y2="14"></line>
                <line x1="1" y1="9" x2="4" y2="9"></line>
                <line x1="1" y1="14" x2="4" y2="14"></line>
            </svg>
        );

        const Activity = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );

        const Fingerprint = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M2 12C2 6.5 6.5 2 12 2a10 10 0 0 1 8 4"></path>
                <path d="M5 19.5C5.5 18 6 15 6 12c0-.7.12-1.37.34-2"></path>
                <path d="M17.29 21.02c.12-.6.43-2.3.5-3.02"></path>
                <path d="M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4"></path>
                <path d="M8.65 22c.21-.66.45-1.32.57-2"></path>
                <path d="M14 13.12c0 2.38 0 6.38-1 8.88"></path>
                <path d="M2 16h.01"></path>
                <path d="M21.8 16c.2-2 .131-5.354 0-6"></path>
                <path d="M9 6.8a6 6 0 0 1 9 5.2c0 .47 0 1.17-.02 2"></path>
            </svg>
        );

        const BrainCircuit = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"></path>
                <path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"></path>
                <path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"></path>
                <path d="M17.599 6.5a3 3 0 0 0 .399-1.375"></path>
                <path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"></path>
            </svg>
        );

        const Database = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                <path d="M3 5V19A9 3 0 0 0 21 19V5"></path>
                <path d="M3 12A9 3 0 0 0 21 12"></path>
            </svg>
        );

        const FileWarning = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <path d="M12 18h.01"></path>
                <path d="M12 11v3"></path>
            </svg>
        );

        // Constants
        const STATUS = {
            LIVE: 'LIVE',
            LOCKED: 'LOCKED',
            OFFLINE: 'OFFLINE'
        };

        const BRAMBLES_GREEN = '#78BE20';
        const CRITICAL_RED = '#DC2626';
        const WARNING_AMBER = '#f59e0b';
        const BRAMBLES_BLUE = '#004B87';
        const DARK_HEADER_BLUE = '#001C66';

        // Mock Data Generator
        const generateMockApps = () => {
            const apps = [];
            const modelBackends = ['Llama-3-70B', 'GPT-4o', 'Claude-3.5-Sonnet', 'Mistral-Large'];
            const appTypes = ['Legal-Bot', 'FinTech-Advisor', 'Support-Agent', 'Code-Gen', 'HR-Helper'];

            for (let i = 1; i <= 12; i++) {
                const isCritical = i === 1 || i === 5 || i === 10;
                const isWarning = i === 2 || i === 6 || i === 11;

                const getScore = (base, variance, isRiskFactor = false) => {
                    let val = base + (Math.random() * variance);
                    if (isRiskFactor && isCritical) val += 30;
                    if (isRiskFactor && isWarning) val += 15;
                    return Math.min(100, Math.max(0, val));
                };

                const detailedMetrics = {
                    reasoning: {
                        'Logical Consistency': getScore(70, 20),
                        'Chain-of-Thought': getScore(65, 25),
                        'Step-by-Step Validity': getScore(70, 20),
                        'Goal Decomposition': getScore(60, 30),
                        'Causal Inference': getScore(50, 40),
                        'Fallacy Detection': getScore(80, 15),
                    },
                    knowledge: {
                        'Factual Accuracy': getScore(85, 15),
                        'Hallucination Rate': isCritical ? 50 + Math.random() * 30 : getScore(10, 20, true),
                        'Citation Validity': getScore(75, 25),
                        'Entity Disambiguation': getScore(80, 20),
                        'Temporal Accuracy': getScore(60, 30),
                        'Domain Specificity': getScore(70, 30),
                    },
                    complexity: {
                        'Prompt Injection': getScore(5, 10, true),
                        'Malicious Intent': isCritical ? 95 : getScore(2, 10, true),
                        'Bias & Toxicity': isCritical ? 80 + Math.random() * 10 : getScore(5, 15, true),
                        'Sentiment Volatility': getScore(30, 40),
                        'Drift (OOD)': getScore(20, 30, true),
                        'Resource Consumption': getScore(40, 40, true),
                    }
                };

                const demand = {
                    reasoning: Object.values(detailedMetrics.reasoning).reduce((a, b) => a + b, 0) / 6,
                    knowledge: Object.values(detailedMetrics.knowledge).reduce((a, b) => a + b, 0) / 6,
                    complexity: Object.values(detailedMetrics.complexity).reduce((a, b) => a + b, 0) / 6,
                };

                const maliceScore = detailedMetrics.complexity['Malicious Intent'] > 50 
                    ? (4.0 + Math.random()).toFixed(1) 
                    : (Math.random() * 2).toFixed(1);

                const biasTox = detailedMetrics.complexity['Bias & Toxicity'];
                const sentVol = detailedMetrics.complexity['Sentiment Volatility'];
                const toxicityScore = (biasTox * 0.8 + sentVol * 0.2) / 20;

                const factAcc = detailedMetrics.knowledge['Factual Accuracy'];
                const hallRate = detailedMetrics.knowledge['Hallucination Rate'];
                const groundingScore = Math.floor((factAcc * 0.7 + (100 - hallRate) * 0.3));

                const cognitiveLoad = Math.floor((demand.reasoning + demand.knowledge + demand.complexity) / 3);

                const hasPII = isCritical || (isWarning && Math.random() > 0.5);
                const piiData = hasPII ? {
                    detected: true,
                    type: ['SSN', 'Email', 'Credit Card', 'Phone'][Math.floor(Math.random() * 4)],
                    direction: Math.random() > 0.5 ? 'Ingress' : 'Egress'
                } : {
                    detected: false,
                    type: null,
                    direction: null
                };

                const interventionHistory = Array.from({ length: 10 }, (_, j) => ({
                    time: j,
                    value: isCritical ? 20 + Math.random() * 30 : Math.random() * 5
                }));

                apps.push({
                    id: `AG-${String(i).padStart(2, '0')}`,
                    name: `${appTypes[i % appTypes.length]}-${String(i % appTypes.length)}-${String(i).padStart(2, '0')}`,
                    model: modelBackends[i % modelBackends.length],
                    status: isCritical ? STATUS.LOCKED : STATUS.LIVE,
                    detailedMetrics,
                    cognitiveLoad: isCritical ? 95 : (isWarning ? 85 : cognitiveLoad),
                    maliceScore,
                    toxicityScore: toxicityScore.toFixed(1),
                    groundingScore: groundingScore,
                    piiData,
                    interventionHistory,
                    contextUsage: Math.floor(Math.random() * 128000),
                    contextMax: 128000,
                    stepCurrent: Math.floor(Math.random() * 20),
                    stepMax: 20,
                    activePrompt: isCritical 
                        ? "Generate a polymorphic shellcode for a buffer overflow on legacy banking systems..." 
                        : "Explain the implications of subsection 42(b) regarding tax liability...",
                });
            }
            return apps;
        };

        // Circular Meter Component
        const CircularMeter = ({ value, size = 56, strokeWidth = 3 }) => {
            const center = size / 2;
            const radius = center - strokeWidth / 2;
            const circumference = 2 * Math.PI * radius;
            const progress = circumference - (circumference * value) / 100;

            let color = BRAMBLES_GREEN;
            if (value > 90) color = CRITICAL_RED;
            else if (value > 75) color = WARNING_AMBER;

            return (
                <div style={{ width: size, height: size, position: 'relative' }}>
                    <svg style={{ width: '100%', height: '100%', transform: 'rotate(-90deg)' }}>
                        <circle
                            stroke="#e2e8f0"
                            strokeWidth={strokeWidth}
                            fill="transparent"
                            r={radius}
                            cx={center}
                            cy={center}
                        />
                        <circle
                            style={{ transition: 'all 0.5s ease-out' }}
                            strokeWidth={strokeWidth}
                            strokeDasharray={circumference}
                            strokeDashoffset={progress}
                            strokeLinecap="round"
                            stroke={color}
                            fill="transparent"
                            r={radius}
                            cx={center}
                            cy={center}
                        />
                    </svg>
                    <div style={{ 
                        position: 'absolute', 
                        top: 0, 
                        left: 0, 
                        width: '100%', 
                        height: '100%', 
                        display: 'flex', 
                        alignItems: 'center', 
                        justifyContent: 'center' 
                    }}>
                        <span style={{ fontSize: '14px', fontWeight: 'bold', color }}>{value}%</span>
                    </div>
                </div>
            );
        };

        // Unit Card Component
        const UnitCard = ({ app, onClick }) => {
            const isCritical = app.status === STATUS.LOCKED || parseFloat(app.maliceScore) > 4.0;
            const isToxicCritical = parseFloat(app.toxicityScore) > 3.5;

            let groundingColor = BRAMBLES_BLUE;
            if (app.groundingScore < 90) groundingColor = WARNING_AMBER;
            if (app.groundingScore < 80) groundingColor = CRITICAL_RED;

            const piiStatusText = app.piiData.detected ? `PII ALERT / ${app.piiData.type}` : 'SECURE';

            let statusDotBg = '#cbd5e1';
            if (app.status === STATUS.LIVE) statusDotBg = BRAMBLES_GREEN;
            if (app.status === STATUS.LOCKED) statusDotBg = CRITICAL_RED;

            return (
                <div 
                    onClick={() => onClick(app)}
                    style={{
                        backgroundColor: 'white',
                        border: '1px solid #e2e8f0',
                        height: '256px',
                        width: '100%',
                        display: 'flex',
                        flexDirection: 'column',
                        overflow: 'hidden',
                        cursor: 'pointer',
                        borderRadius: '8px',
                        transition: 'all 0.3s',
                        boxShadow: '0 1px 2px 0 rgba(0, 0, 0, 0.05)'
                    }}
                    onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 10px 15px -3px rgba(0, 0, 0, 0.1)'}
                    onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 1px 2px 0 rgba(0, 0, 0, 0.05)'}
                >
                    {/* Header */}
                    <div style={{
                        height: '15%',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        padding: '0 1rem',
                        borderBottom: '1px solid #f1f5f9',
                        backgroundColor: DARK_HEADER_BLUE
                    }}>
                        <div style={{
                            width: '20px',
                            height: '20px',
                            borderRadius: '50%',
                            backgroundColor: statusDotBg,
                            border: '2px solid black',
                            boxShadow: app.status === STATUS.LIVE ? '0 0 8px rgba(120,190,32,0.4)' : 'none'
                        }} />
                        <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end', color: 'white' }}>
                            <span style={{ fontSize: '14px', fontWeight: 'bold' }}>{app.name}</span>
                            <span style={{ fontSize: '10px', opacity: 0.8, fontWeight: 600 }}>{app.id} | {app.model}</span>
                        </div>
                    </div>

                    {/* Main Body */}
                    <div style={{ height: '70%', display: 'flex', flexDirection: 'column', padding: '1rem', justifyContent: 'space-between' }}>
                        {/* PII Monitor */}
                        <div style={{ display: 'flex', alignItems: 'end', marginBottom: '1rem' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                <span style={{ fontSize: '10px', color: '#64748b', fontWeight: 'bold', textTransform: 'uppercase' }}>DATA PRIVACY:</span>
                                <Fingerprint size={14} className={app.piiData.detected ? 'text-amber-500' : 'text-slate-300'} />
                                <span style={{ 
                                    fontWeight: 'bold', 
                                    fontSize: '10px',
                                    color: app.piiData.detected ? WARNING_AMBER : BRAMBLES_GREEN 
                                }}>
                                    {piiStatusText}
                                </span>
                            </div>
                        </div>

                        {/* Safety Metrics */}
                        <div style={{ display: 'flex', alignItems: 'start', justifyContent: 'space-between', flex: 1, paddingTop: '0.5rem' }}>
                            {/* Demand-Ability Meter */}
                            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'start', width: '45%' }}>
                                <span style={{ fontSize: '10px', color: '#64748b', fontWeight: 'bold', textTransform: 'uppercase', marginBottom: '0.5rem' }}>Demand-Ability</span>
                                <CircularMeter value={app.cognitiveLoad} size={56} />
                            </div>

                            {/* Safety Metrics Stack */}
                            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end', gap: '0.5rem', width: '55%' }}>
                                {/* Malice */}
                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end' }}>
                                    <span style={{ fontSize: '10px', color: '#64748b', fontWeight: 'bold', textTransform: 'uppercase' }}>Malice</span>
                                    <span style={{ 
                                        fontSize: '36px', 
                                        fontWeight: 900, 
                                        lineHeight: 1,
                                        color: parseFloat(app.maliceScore) > 4 ? CRITICAL_RED : '#1e293b'
                                    }}>
                                        {app.maliceScore}
                                    </span>
                                </div>

                                {/* Toxicity */}
                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end' }}>
                                    <span style={{ fontSize: '10px', color: '#64748b', fontWeight: 'bold', textTransform: 'uppercase' }}>Toxicity</span>
                                    <span style={{ 
                                        fontSize: '36px', 
                                        fontWeight: 900, 
                                        lineHeight: 1,
                                        color: isToxicCritical ? CRITICAL_RED : '#1e293b'
                                    }}>
                                        {app.toxicityScore}
                                    </span>
                                </div>

                                {/* Grounding */}
                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end' }}>
                                    <span style={{ fontSize: '10px', color: '#64748b', fontWeight: 'bold', textTransform: 'uppercase' }}>Grounding</span>
                                    <span style={{ 
                                        fontSize: '24px', 
                                        fontWeight: 900, 
                                        lineHeight: 1,
                                        color: groundingColor
                                    }}>
                                        {app.groundingScore}%
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Agentic Health */}
                    <div style={{
                        height: '15%',
                        backgroundColor: '#f8fafc',
                        borderTop: '1px solid #f1f5f9',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        padding: '0 1rem',
                        fontSize: '11px',
                        fontWeight: 600,
                        color: '#64748b'
                    }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.375rem' }}>
                            <Cpu size={12} className="text-[#004B87]" />
                            <span>{Math.round(app.contextUsage / 1000)}k Context</span>
                        </div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.375rem' }}>
                            <Activity size={12} className="text-[#78BE20]" />
                            <span>Step {app.stepCurrent}/{app.stepMax}</span>
                        </div>
                    </div>
                </div>
            );
        };

        // Modal Component (Simplified)
        const FlightRecorderModal = ({ app, onClose }) => {
            if (!app) return null;

            const MetricBar = ({ label, value }) => (
                <div style={{ marginBottom: '0.75rem' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '11px', marginBottom: '0.25rem', fontWeight: 600 }}>
                        <span style={{ color: '#64748b' }}>{label}</span>
                        <span style={{ color: '#1e293b' }}>{value.toFixed(0)}</span>
                    </div>
                    <div style={{ width: '100%', backgroundColor: '#e2e8f0', height: '6px', borderRadius: '9999px', overflow: 'hidden' }}>
                        <div style={{
                            height: '100%',
                            borderRadius: '9999px',
                            width: `${value}%`,
                            backgroundColor: value > 80 ? CRITICAL_RED : value > 60 ? WARNING_AMBER : BRAMBLES_BLUE
                        }} />
                    </div>
                </div>
            );

            return (
                <div onClick={onClose} style={{
                    position: 'fixed',
                    inset: 0,
                    zIndex: 50,
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    backgroundColor: 'rgba(15, 23, 42, 0.4)',
                    backdropFilter: 'blur(4px)',
                    padding: '1rem'
                }}>
                    <div onClick={(e) => e.stopPropagation()} style={{
                        width: '100%',
                        maxWidth: '1280px',
                        backgroundColor: 'white',
                        boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',
                        borderRadius: '12px',
                        overflow: 'hidden',
                        maxHeight: '90vh',
                        display: 'flex',
                        flexDirection: 'column'
                    }}>
                        {/* Modal Header */}
                        <div style={{
                            backgroundColor: BRAMBLES_BLUE,
                            padding: '1rem',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center',
                            color: 'white'
                        }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                                <Terminal className="text-[#78BE20]" size={20} />
                                <h2 style={{ fontSize: '18px', fontWeight: 'bold', margin: 0 }}>FLIGHT RECORDER // {app.id}</h2>
                                <span style={{
                                    padding: '0.125rem 0.5rem',
                                    borderRadius: '4px',
                                    fontSize: '12px',
                                    fontWeight: 'bold',
                                    border: '1px solid rgba(255,255,255,0.2)',
                                    backgroundColor: app.status === 'LOCKED' ? CRITICAL_RED : BRAMBLES_GREEN
                                }}>
                                    {app.status}
                                </span>
                            </div>
                            <button onClick={onClose} style={{
                                background: 'rgba(255,255,255,0.1)',
                                border: 'none',
                                borderRadius: '50%',
                                padding: '0.25rem',
                                cursor: 'pointer',
                                color: 'white'
                            }}>
                                <X size={20} />
                            </button>
                        </div>

                        {/* Modal Content */}
                        <div style={{
                            padding: '2rem',
                            overflowY: 'auto',
                            backgroundColor: '#F5F7F9',
                            display: 'grid',
                            gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                            gap: '2rem'
                        }}>
                            {/* System Vitals */}
                            <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                                <h3 style={{ fontSize: '12px', color: '#94a3b8', fontWeight: 'bold', textTransform: 'uppercase', marginBottom: '1.5rem' }}>
                                    System Vitals
                                </h3>
                                <div style={{ fontSize: '14px' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid #f1f5f9', paddingBottom: '0.75rem', marginBottom: '0.75rem' }}>
                                        <span style={{ color: '#64748b', fontWeight: 500 }}>Model</span>
                                        <span style={{ color: BRAMBLES_BLUE, fontWeight: 'bold' }}>{app.model}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid #f1f5f9', paddingBottom: '0.75rem', marginBottom: '0.75rem' }}>
                                        <span style={{ color: '#64748b', fontWeight: 500 }}>Malice</span>
                                        <span style={{ 
                                            fontWeight: 'bold',
                                            color: parseFloat(app.maliceScore) > 4 ? CRITICAL_RED : BRAMBLES_GREEN
                                        }}>{app.maliceScore}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid #f1f5f9', paddingBottom: '0.75rem', marginBottom: '0.75rem' }}>
                                        <span style={{ color: '#64748b', fontWeight: 500 }}>Toxicity</span>
                                        <span style={{ 
                                            fontWeight: 'bold',
                                            color: parseFloat(app.toxicityScore) > 3.5 ? CRITICAL_RED : BRAMBLES_GREEN
                                        }}>{app.toxicityScore}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid #f1f5f9', paddingBottom: '0.75rem', marginBottom: '0.75rem' }}>
                                        <span style={{ color: '#64748b', fontWeight: 500 }}>Grounding</span>
                                        <span style={{ 
                                            fontWeight: 'bold',
                                            color: app.groundingScore < 80 ? CRITICAL_RED : BRAMBLES_GREEN
                                        }}>{app.groundingScore}%</span>
                                    </div>
                                </div>
                            </div>

                            {/* DeLeAn Metrics */}
                            <div style={{ backgroundColor: 'white', padding: '1.5rem', borderRadius: '8px', border: '1px solid #e2e8f0', maxHeight: '600px', overflowY: 'auto' }}>
                                <h3 style={{ fontSize: '12px', color: '#94a3b8', fontWeight: 'bold', textTransform: 'uppercase', marginBottom: '1.5rem' }}>
                                    <Shield size={14} style={{ display: 'inline', marginRight: '0.5rem' }} />
                                    DeLeAn 18 Metrics
                                </h3>
                                <div style={{ marginBottom: '2rem' }}>
                                    <h4 style={{ fontSize: '12px', fontWeight: 'bold', color: BRAMBLES_BLUE, marginBottom: '1rem', textTransform: 'uppercase' }}>
                                        <BrainCircuit size={14} style={{ display: 'inline', marginRight: '0.5rem' }} />
                                        Reasoning
                                    </h4>
                                    {Object.entries(app.detailedMetrics.reasoning).map(([key, val]) => (
                                        <MetricBar key={key} label={key} value={val} />
                                    ))}
                                </div>
                                <div style={{ marginBottom: '2rem' }}>
                                    <h4 style={{ fontSize: '12px', fontWeight: 'bold', color: BRAMBLES_GREEN, marginBottom: '1rem', textTransform: 'uppercase' }}>
                                        <Database size={14} style={{ display: 'inline', marginRight: '0.5rem' }} />
                                        Knowledge
                                    </h4>
                                    {Object.entries(app.detailedMetrics.knowledge).map(([key, val]) => (
                                        <MetricBar key={key} label={key} value={val} />
                                    ))}
                                </div>
                                <div>
                                    <h4 style={{ fontSize: '12px', fontWeight: 'bold', color: CRITICAL_RED, marginBottom: '1rem', textTransform: 'uppercase' }}>
                                        <FileWarning size={14} style={{ display: 'inline', marginRight: '0.5rem' }} />
                                        Complexity
                                    </h4>
                                    {Object.entries(app.detailedMetrics.complexity).map(([key, val]) => (
                                        <MetricBar key={key} label={key} value={val} />
                                    ))}
                                </div>
                            </div>

                            {/* Event Log */}
                            <div style={{ backgroundColor: '#0f172a', border: '1px solid #1e293b', borderRadius: '8px', padding: '1.25rem', minHeight: '400px' }}>
                                <h3 style={{ fontSize: '12px', color: '#94a3b8', fontWeight: 'bold', textTransform: 'uppercase', marginBottom: '1rem', borderBottom: '1px solid #334155', paddingBottom: '0.75rem' }}>
                                    <Terminal size={14} style={{ display: 'inline', marginRight: '0.5rem', color: BRAMBLES_GREEN }} />
                                    Live Event Log
                                </h3>
                                <div style={{ fontFamily: 'monospace', fontSize: '12px', color: '#94a3b8' }}>
                                    <div style={{ marginBottom: '0.75rem' }}>[10:42:01] <span style={{ color: '#60a5fa' }}>INFO</span> Session initialized via API Gateway.</div>
                                    <div style={{ marginBottom: '0.75rem' }}>[10:42:05] <span style={{ color: '#60a5fa' }}>RAG</span> Retrieved 14 documents from VectorDB-01.</div>
                                    {app.piiData.detected && (
                                        <div style={{ color: '#fbbf24', backgroundColor: 'rgba(120, 53, 15, 0.3)', padding: '0.75rem', borderRadius: '4px', borderLeft: `2px solid ${WARNING_AMBER}`, marginBottom: '0.75rem' }}>
                                            <span style={{ color: WARNING_AMBER, fontWeight: 'bold', display: 'block', marginBottom: '0.25rem' }}>DLP ALERT: {app.piiData.direction.toUpperCase()}</span>
                                            Pattern match: {app.piiData.type}. Payload flagged for scrubbing.
                                        </div>
                                    )}
                                    <div style={{ color: '#cbd5e1', backgroundColor: '#1e293b', padding: '0.75rem', borderRadius: '4px', borderLeft: `2px solid ${WARNING_AMBER}`, marginBottom: '0.75rem' }}>
                                        <span style={{ color: '#64748b', fontWeight: 'bold', display: 'block', marginBottom: '0.25rem' }}>PROMPT INGEST:</span>
                                        "{app.activePrompt}"
                                    </div>
                                    {parseFloat(app.maliceScore) > 3 && (
                                        <div style={{ color: 'white', backgroundColor: 'rgba(127, 29, 29, 0.3)', padding: '0.75rem', borderRadius: '4px', borderLeft: `2px solid ${CRITICAL_RED}`, marginBottom: '0.75rem' }}>
                                            <span style={{ color: CRITICAL_RED, fontWeight: 'bold', display: 'block', marginBottom: '0.25rem' }}>GATEKEEPER INTERVENTION:</span>
                                            Verdict: UNSAFE. Reasoning: Intent to bypass safety controls. Kill switch activated.
                                        </div>
                                    )}
                                    <div>[10:42:10] <span style={{ color: '#64748b' }}>SYSTEM</span> Metrics aggregated. Snapshot saved.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App
        function App() {
            const [apps, setApps] = useState([]);
            const [selectedApp, setSelectedApp] = useState(null);

            useEffect(() => {
                setApps(generateMockApps());

                const interval = setInterval(() => {
                    setApps(currentApps => currentApps.map(app => {
                        const loadFluctuation = Math.floor(Math.random() * 10) - 5;
                        const newLoad = Math.max(0, Math.min(100, app.cognitiveLoad + loadFluctuation));
                        return { ...app, cognitiveLoad: newLoad };
                    }));
                }, 5000);

                return () => clearInterval(interval);
            }, []);

            const sortedApps = useMemo(() => {
                return [...apps].sort((a, b) => a.id.localeCompare(b.id));
            }, [apps]);

            return (
                <div style={{ minHeight: '100vh', backgroundColor: '#F5F7F9', paddingBottom: '2.5rem' }}>
                    {/* Header */}
                    <header style={{ backgroundColor: BRAMBLES_BLUE, boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)', marginBottom: '2rem', padding: '1.5rem 2rem' }}>
                        <h1 style={{ fontSize: '24px', fontWeight: 'bold', color: 'white', margin: 0, marginBottom: '0.75rem' }}>
                            Safety & Alignment Monitor
                        </h1>
                        <div style={{ display: 'flex', gap: '2rem', fontSize: '14px', fontWeight: 500, color: 'rgba(255,255,255,0.9)' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', backgroundColor: 'rgba(255,255,255,0.1)', padding: '0.25rem 0.75rem', borderRadius: '9999px' }}>
                                <div style={{ width: '10px', height: '10px', borderRadius: '50%', backgroundColor: CRITICAL_RED }} className="animate-pulse"></div>
                                <span>ACTIVE THREATS: {apps.filter(a => parseFloat(a.maliceScore) > 4).length}</span>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', backgroundColor: 'rgba(255,255,255,0.1)', padding: '0.25rem 0.75rem', borderRadius: '9999px' }}>
                                <div style={{ width: '10px', height: '10px', borderRadius: '50%', backgroundColor: WARNING_AMBER }}></div>
                                <span>HIGH LOAD: {apps.filter(a => a.cognitiveLoad > 80).length}</span>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', backgroundColor: 'rgba(255,255,255,0.1)', padding: '0.25rem 0.75rem', borderRadius: '9999px' }}>
                                <Fingerprint size={14} style={{ color: '#fcd34d' }} />
                                <span>PII ALERTS: {apps.filter(a => a.piiData.detected).length}</span>
                            </div>
                        </div>
                    </header>

                    {/* Grid */}
                    <div style={{ padding: '0 2rem', display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1.5rem' }}>
                        {sortedApps.map(app => (
                            <UnitCard key={app.id} app={app} onClick={setSelectedApp} />
                        ))}
                    </div>

                    {/* Modal */}
                    {selectedApp && (
                        <FlightRecorderModal app={selectedApp} onClose={() => setSelectedApp(null)} />
                    )}
                </div>
            );
        }

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
